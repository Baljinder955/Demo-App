# This file contains the fastlane.tools configuration
# You can find the documentation at https://docs.fastlane.tools
#
# For a list of all available actions, check out
#
#     https://docs.fastlane.tools/actions
#
# For a list of all available plugins, check out
#
#     https://docs.fastlane.tools/plugins/available-plugins
#

# Uncomment the line if you want fastlane to automatically update itself
# update_fastlane


default_platform(:ios)

platform :ios do

  ######################################################
  # ğŸš€ CI Build Lane (NO signing, NO export)
  ######################################################
  desc "ğŸ—ï¸ Build the app for CI (no signing)"
  lane :build_ci do
    gym(
      project: "SpeechToText.xcodeproj",   # or workspace: "SpeechToText.xcworkspace"
      scheme: "SpeechToText",
      configuration: "Debug",
      clean: true,
      skip_archive: false,
      skip_codesigning: true,              # ğŸ”¥ correct key
      export_method: nil
    )
    UI.success("ğŸ‰ CI Build Completed (No Signing)")
  end


  ######################################################
  # ğŸ§ª Test Lane (renamed to avoid conflict)
  ######################################################
  desc "ğŸ§ª Run tests for CI"
  lane :ci_tests do
    scan(
      project: "SpeechToText.xcodeproj",   # or workspace if needed
      scheme: "SpeechToText",
      clean: true
    )
    UI.success("ğŸ§ª Test execution completed")
  end


  ######################################################
  # ğŸ‘¨â€ğŸ’» Local Build (optional)
  ######################################################
  desc "ğŸ‘¨â€ğŸ’» Local debug build"
  lane :build_local do
    gym(
      project: "SpeechToText.xcodeproj",
      scheme: "SpeechToText",
      configuration: "Debug",
      skip_codesigning: true,
      export_method: nil
    )
    UI.message("ğŸ“¦ Local build done")
  end

end
